<signed-in-csr hidden>
  <slot />
</signed-in-csr>

<script>
  import { $authStore, $clerkLoadedStore } from '@clerk/astro/client';

  class SignedInCSR extends HTMLElement {
    constructor() {
      super();
    }

    connectedCallback() {
      $clerkLoadedStore.subscribe((loaded) => {
        if (loaded) {
          this.subscribeToAuthStore();
        }
      });
    }

    subscribeToAuthStore() {
      $authStore.subscribe((state) => {
        if (state.userId) {
          this.removeAttribute('hidden');
        } else {
          this.setAttribute('hidden', '');
        }
      });
    }
  }

  customElements.define('signed-in-csr', SignedInCSR);
</script>
