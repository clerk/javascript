---
import SignedOutCSR from './SignedOutCSR.astro';
import SignedOutSSR from './SignedOutSSR.astro';

import { isStaticOutput } from 'virtual:@clerk/astro/config';

type Props = {
  isStatic?: boolean;
  /**
   * The class name to apply to the outermost element of the component.
   * This class is only applied to static components.
   */
  class?: string;
};

const { isStatic, class: className } = Astro.props;

// If user explicitly sets isStatic prop, honor it
// Otherwise, detect based on runtime (whether auth function exists)
const shouldUseCSR = isStatic !== undefined ? isStaticOutput(isStatic) : !Astro.locals.auth;
const SignedOutComponent = shouldUseCSR ? SignedOutCSR : SignedOutSSR;
---

<SignedOutComponent class={className}>
  <slot />
</SignedOutComponent>
