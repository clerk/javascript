apply plugin: 'com.android.library'
apply plugin: 'kotlin-android'

group = 'com.clerk.expo'
version = '1.0.0'

// Dependency versions - centralized for easier updates
// See: https://docs.gradle.org/current/userguide/version_catalogs.html for app-level version catalogs
ext {
  credentialsVersion = "1.3.0"
  googleIdVersion = "1.1.1"
  kotlinxCoroutinesVersion = "1.7.3"
}

def safeExtGet(prop, fallback) {
  rootProject.ext.has(prop) ? rootProject.ext.get(prop) : fallback
}

android {
  namespace "expo.modules.clerk.googlesignin"

  compileSdk safeExtGet("compileSdkVersion", 36)

  defaultConfig {
    minSdk safeExtGet("minSdkVersion", 24)
    targetSdk safeExtGet("targetSdkVersion", 36)
    versionCode 1
    versionName "1.0.0"
  }

  buildTypes {
    release {
      minifyEnabled false
    }
  }

  compileOptions {
    sourceCompatibility JavaVersion.VERSION_17
    targetCompatibility JavaVersion.VERSION_17
  }

  kotlinOptions {
    jvmTarget = "17"
  }

  sourceSets {
    main {
      java.srcDirs = ['src/main/java']
    }
  }
}

dependencies {
  // Expo modules core
  implementation project(':expo-modules-core')

  // Credential Manager for Google Sign-In with nonce support
  implementation "androidx.credentials:credentials:$credentialsVersion"
  implementation "androidx.credentials:credentials-play-services-auth:$credentialsVersion"
  implementation "com.google.android.libraries.identity.googleid:googleid:$googleIdVersion"

  // Coroutines for async operations
  implementation "org.jetbrains.kotlinx:kotlinx-coroutines-android:$kotlinxCoroutinesVersion"
}
